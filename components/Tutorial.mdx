# ChEA-KG: Exploring a Human Gene Regulatory Network
### Table of Contents
1. [The ChEA-KG GRN](#introduction)
    1. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[Searching the KG](#grn-search)
		1. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[Single Term Search](#single-search)
        2. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[Subnetwork Search](#subgraph-search)
		3. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[Two Term Search](#two-term-search)
    1. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[Interacting with the network](#interact-network)
        1. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[Adjust network view](#adjust-vew)
        2. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[Download network](#download)
2. [Enrichment analysis with ChEA-KG](#chea-enrichment)
	1. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[Subnetwork](#enrichment-subnetwork)
	2. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[Search parameters](#enrichment-params)
	3. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[Perform a query](#perform-query)

<br/><br/>

## **The ChEA-KG GRN** <a name="introduction"></a>

### Abstract
Gene expression is controlled by transcription factors that selectively bind to DNA to regulate mRNA expression of all human genes. Transcription factors control the expression of other transcription factors, forming a complex gene regulatory network (GRN) with switches, feedback loops, and other regulatory motifs. Many experimental methods and computational tools have been developed to reconstruct GRNs in-silico. Here we present a different approach to reconstruct the human GRN. By submitting thousands of gene sets from the RummaGEO resource for transcription factor enrichment analysis with ChEA3, we are able to distill signed and directed edges that connect all human transcription factors to construct a high quality human GRN. The GRN has 130,793 signed and directed edges between 703 source and 1,543 target transcription factors. The network is made accessible via an interactive web-based application called ChEA-KG. ChEA-KG enables users to query the GRN by searching for single or pairs of transcription factors, as well as by submitting gene sets to perform transcription factor enrichment analysis with ChEA3 and then place the enriched transcription factors in context of ChEA-KG. To demonstrate the utility of ChEA-KG, we systematically identified transcription factor subnetworks that regulate differentially expressed genes in tumors from ten cancer types, and 69 subtypes, profiled by the Clinical Proteomic Tumor Analysis Consortium (CPTAC). 

<img src="https://minio.dev.maayanlab.cloud/hgrn-chear/tutorial/search-home.png" alt="drawing" width="600"/> 

***Nodes*** 

Nodes in the ChEA-KG are human transcription factors cataloged by [ChEA3](https://maayanlab.cloud/chea3/). Each node is associated with an **id, label**, and **URI** that points to the NCBI gene page for that gene.  

***Edges*** 

Edges in the GRN indicate regulatory relationships between source and target TFs, inferred from enrichment analysis. There are two edge types:   
    1 - <span style="color: red;">Red</span> plungers indicate downregulation  
    2 - <span style="color: green;">Green</span> arrows indicate upregulation  

<img src="https://minio.dev.maayanlab.cloud/hgrn-chear/tutorial/introduction.png" alt="drawing" width="400"/> 

<p>&nbsp;</p>

### **Searching the ChEA-KG GRN** <a name="grn-search"></a>
Click and drag on any node to move it. 

#### *One-term search* <a name="single-search"></a>
Generate a subnetwork of interactions between a single transcription factor and its neighboring nodes by inputting the gene symbol for a transcription factor into the "Start with" field. Type in the gene symbol. If it exists in the network, it will be shown in the autocomplete menu. Click on the matching name to view the results. 
<img src="https://minio.dev.maayanlab.cloud/hgrn-chear/tutorial/single-term.png" alt="drawing" width="600"/> 

#### *Subgraph search* <a name="subgraph-search"></a>
Generate a subnetwork with a given number of relationships by toggling the "End Node" switch. Leave the "End with" field **blank**. Control the size of the subnetwork using the slider above the network view. 
<img src="https://minio.dev.maayanlab.cloud/hgrn-chear/tutorial/subgraph.png" alt="drawing" width="600"/> 


#### *Two-term search* <a name="two-term-search"></a>
The two-term search generates a shortest path between two transcription factor nodes. Enter a starting transcription factor in the "Start with" field. Toggle the "End Node" switch, then input a desired end node in the "End with" field. The result displays a shorest path between the two nodes. In the case where there is a tie for a shortest path length, all paths of that length are shown. 
<img src="https://minio.dev.maayanlab.cloud/hgrn-chear/tutorial/two-term.png" alt="drawing" width="600"/> 


### **Interacting with the network** <a name="interact-network"></a>
The toolbar above the network view provides several buttons to further interact with the network. From left to right, these are Size, Full-screen, Network view, Table view, Save subnetwork, Download graph as an image file, Show tooltip, Switch graph layout, Show edge labels, and Show legend.  

To move a node in the network view, click and drag. 
 
#### *Adjust the network view:* <a name="adjust-view"></a>
**Adjust subnetwork size:**  
Adjust the size slider to limit the number of relationships displayed for that network
<img src="https://minio.dev.maayanlab.cloud/hgrn-chear/tutorial/network_size.png" alt="drawing" width="600"/> 

**Full-screen:**  
Click the full-screen button to view the network search page in full-screen.  
**Enable the tooltip:**  
The tooltip displays the ID, label, and URI for each node when the mouse hovers over a node in the network. It also provides options to remove or expand a node.  
<img src="https://minio.dev.maayanlab.cloud/hgrn-chear/tutorial/tooltip.png" alt="drawing" width="600"/> 

**Delete or expand a node:**  
With the tooltip enabled, hover over the node of interest and click on the delete or expand buttons.  
Expand | Delete
<img src="https://minio.dev.maayanlab.cloud/hgrn-chear/tutorial/expand1.png" alt="drawing" width="400"/> <img src="https://minio.dev.maayanlab.cloud/hgrn-chear/tutorial/delete1.png" alt="drawing" width="400"/>  
<img src="https://minio.dev.maayanlab.cloud/hgrn-chear/tutorial/expand2.png" alt="drawing" width="400"/> <img src="https://minio.dev.maayanlab.cloud/hgrn-chear/tutorial/delete2.png" alt="drawing" width="400"/>    
  
**Network and table view:**  
Toggle between network and table view by clicking on their respective buttons
<img src="https://minio.dev.maayanlab.cloud/hgrn-chear/tutorial/table_view.png" alt="drawing" width="600"/> 

**Switch graph layout:**  
Switch between force-directed, geometric, or hierarchical graph layouts. 
<img src="https://minio.dev.maayanlab.cloud/hgrn-chear/tutorial/heirarchical-layout.png" alt="drawing" width="600"/> 

**Show edge labels:**  
Display the edge labels ("upregulates", "downregulates") over the edges
<img src="https://minio.dev.maayanlab.cloud/hgrn-chear/tutorial/edge-label.png" alt="drawing" width="600"/> 

**Show legend:**  
Show the legend. An additional toolbar button is displayed that adjusts the size of the legend when clicked.  
<img src="https://minio.dev.maayanlab.cloud/hgrn-chear/tutorial/legend.png" alt="drawing" width="600"/> 

 

#### *Download the subnetwork:*  <a name="download"></a>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*Save subnetwork:* Save the subnetwork to a file. This produces two files:   
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 1&nbsp;-&nbsp;nodes.csv has the fields [id, label, kind, uri, color]  
    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; 2&nbsp;-&nbsp;edges.csv has the  fields [source, target, relation, source_label, target_label, kind, p_value, z_score]  
<p>&nbsp;</p>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*Download graph as an image file:* Save a PNG, JPG, or SVG image of the network view  
<p>&nbsp;</p>


## **Enrichment analysis with ChEA-KG** <a name="chea-enrichment"></a>
The enrichment analysis page provides an option to visualize a subnetwork of the GRN based on ChEA3 enrichment analysis results. 
<img src="https://minio.dev.maayanlab.cloud/hgrn-chear/tutorial/enrichment_home.png" alt="drawing" width="600"/> 

### Enrichment analysis subnetwork <a name="enrichment-subnetwork"></a>
The subnetwork returned by this feature contains transcription factors with the highest integrated mean rank for that gene set. By default, the top 10 ranked TFs are returned. The ChEA3 integrated mean rank is calculated from the average rank across six libraries: Enrichr Queries, GTEx Coexpression, ARCHS4 Coexpression, ENCODE ChIP-seq, Literature ChIP-seq, and ReMap ChIP-seq. For more information on how the ChEA3 Integrated Mean Rank is calculated, visit the [ChEA3 website](https://maayanlab.cloud/chea3/). 

### Enrichment analysis search parameters: <a name="enrichment-params"></a>
There are three advanced search options that can be adjusted by toggling "Advanced Options".  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1 - Minimum libraries: This filters out nodes from the enrichment results if they occur in fewer than the specified number of ChEA3 libraries (maximum of 6)  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2 - Maximum edge p-value: Specify the maximum p-value of an edge.  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3 - Specify number of nodes: Specify how many top ranked nodes.  

### Perform a query:<a name="perform-query"></a>
To perform a query, input a list of newline-separated Entrez gene symbols into the text box. Alternatively, click "try an example" to use an example gene set. Add a description under the "Description" field. Adjust the advanced options as necessary. Click submit. 